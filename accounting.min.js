!function(a,b){function c(a){return!!(""===a||a&&a.charCodeAt&&a.substr)}function d(a){return m?m(a):"[object Array]"===n.call(a)}function e(a){return a&&"[object Object]"===n.call(a)}function f(a,b){var c;a=a||{},b=b||{};for(c in b)b.hasOwnProperty(c)&&(c in a&&a[c]||(a[c]=b[c]));return a}function g(a,b,c){var d=[],e=0,f=0;if(!a)return d;if(l&&a.map===l)return a.map(b,c);for(e=0,f=a.length;f>e;e++)d[e]=b.call(c,a[e],e,a);return d}function h(a){return a&&a in k.settings?f(k.settings[a],k.settings["default"]):k.settings["default"]}function i(a,b){return a=Math.round(Math.abs(a)),isNaN(a)?b:a}function j(a,b){return"function"==typeof a&&(a=a()),a=a||h(b).currency.format,e(a)&&"pos"in a&&"neg"in a&&"zero"in a?a:(c(a)&&a.match("%v")||(a=h().currency.format),a={pos:a,neg:a.replace("-","").replace("%v","-%v"),zero:a},b&&b in k.settings&&(k.settings[b].currency.format=a),a)}var k={};k.version="0.4.2-f0.1",k.settings={},k.settings["default"]={currency:{symbol:"$",format:"%s%v",decimal:".",thousand:",",precision:2,grouping:3},number:{precision:0,grouping:3,thousand:",",decimal:"."}},k.settings.ru={currency:{symbol:"���",format:"%v %s"}};var l=Array.prototype.map,m=Array.isArray,n=Object.prototype.toString,o=function(a,b,c){if(d(a))return g(a,function(a){return o(a,b,c)});if(a=a||0,"number"==typeof a)return a;c&&(b=h(c).number.decimal),b=b||h().number.decimal;var e=new RegExp("[^0-9-"+b+"]",["g"]),f=parseFloat((""+a).replace(/\((.*)\)/,"-$1").replace(e,"").replace(b,"."));return isNaN(f)?0:f};k.unformat=k.parse=o;var p=function(a,d){var e=b;c(d)&&d in k.settings&&(e=d,d=b),d=i(d,h(e).number.precision);var f=Math.pow(10,d);return(Math.round(k.unformat(a)*f)/f).toFixed(d)};k.toFixed=p;var q=function(a,j,l,m){var n=b,r={},s=0,t="",u=0,v=0;return d(a)?g(a,function(a){return q(a,j,l,m)}):(c(j)&&j in k.settings&&(n=j,j=b),a=o(a),j=e(j)?j:{precision:j,thousand:l,decimal:m},r=f(j,h(n).number),s=i(r.precision),t=0>a?"-":"",u=parseInt(p(Math.abs(a||0),s),10)+"",v=u.length>3?u.length%3:0,t+(v?u.substr(0,v)+r.thousand:"")+u.substr(v).replace(/(\d{3})(?=\d)/g,"$1"+r.thousand)+(s?r.decimal+p(Math.abs(a),s).split(".")[1]:""))};k.formatNumber=k.format=q;var r=function(a,l,m,n,p,s){var t=b,u={},v={},w="";return d(a)?g(a,function(a){return r(a,l,m,n,p,s)}):(c(l)&&l in k.settings&&(t=l,l=b),a=o(a),m=e(m)?m:{symbol:m,precision:l,thousand:n,decimal:p,format:s},u=f(m,h(t).currency),v=j(u.format,t),w=a>0?v.pos:0>a?v.neg:v.zero,w.replace("%s",u.symbol).replace("%v",q(Math.abs(a),i(u.precision),u.thousand,u.decimal)))};k.formatMoney=r,"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=k),exports.accounting=k):"function"==typeof define&&define.amd?define([],function(){return k}):(k.noConflict=function(c){return function(){return a.accounting=c,k.noConflict=b,k}}(a.accounting),a.accounting=k)}(this);